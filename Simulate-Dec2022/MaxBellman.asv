function [V1, xp] = MaxBellman( Par, V0, Grid )
%MAXBELLMAN 
% Maximizes the RHS of the Bellman equation using golden section search
% Inputs
% Grid n*1

p = (sqrt(5)-1)/2;

A = Grid.x(1) * ones(Grid.nx,1);
D = Grid.x(Grid.nx) * ones(Grid.nx,1); 

B = p*A + (1-p)*D;
C = (1-p)*A + p*D;

fB = Bellman(Par, V0, Grid, B);
fC = Bellman(Par, V0, Grid, C);

MAXIT = 1e3;
for it = 1: MAXIT
      if all(D-A < 1e-6)
          break
      end
      
      I = fB > fC;
      
      D(I) = C(I); % discard  [C, D], C becomes D, 
      C(I) = B(I); %B becomes C
      fC(I) = fB(I);
      B(I) = (1-p)*A(I) + p*C(I); % calculate new B
      fB_fulleval = Bellman(Par, V0, Grid, B);
      % Bellman can only evaluate the whole grid
      fB(I) = fB_fulleval(I);
      
      A(~I) = B(~I); % discard [A,B] B becomes A
      B(~I) = C(~I); % C becomes B
      fB(~I) = fC(~I) ;
      C(~I) = p*B(~I) + (1-p)*D(~I); % calculate new C
      fC_fulleval = Bellman(Par, V0, Grid, C);
      % Bellman can only evaluate the whole grid
      fC(~I) = fC_fulleval(~I);

end

% now our 


end

